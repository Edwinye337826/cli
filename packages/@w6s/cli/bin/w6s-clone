#!/usr/bin/env node

require('colors');

const path = require('path');
const program = require('commander');
const { logger } = require('@w6s/cli-shared-utils');

const clone = require('../lib/clone');
const { logCompleteMsg } = require('../lib/logCompleteMsg');

/**
 * Padding.
 */

console.log()
process.on('exit', () => {
  console.log()
})

/**
* Usage
*/
program.usage('<template-name> [project-name]')

/**
* Help
*/
program.on('--help', () => {
  console.log('  Examples:');
  console.log('');
  console.log('    # create a new project with an official template'.gray);
  console.log('    $ w6s clone demo7 my-project');
  console.log('');
});

/**
 * Agrs params
 */

program.parse(process.argv);
const { args } = program;

if (args.length < 1) {
  program.help();
} else {
  const template = args[0];
  const pathName = args[1];
  const inPlace = !pathName || pathName === '.';
  const destination = path.resolve(pathName || '.');
  const name = !pathName ? template : pathName;

  clone(name, template, destination, inPlace, true)
    .then(logCompleteMsg)
    .catch((err) => {
      logger.error(err);
      process.exit(1);
    });
}
